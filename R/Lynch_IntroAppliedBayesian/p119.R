x=matrix(NA,2,1377)
x[,1:361]=c(1,1); x[,362:448]=c(1,2); x[,449:487]=c(1,3);
x[,488:495]=c(1,4); x[,496:497]=c(1,5); x[,498:499]=c(1,6);
x[,500:608]=c(2,1); x[,609:801]=c(2,2); x[,802:852]=c(2,3);
x[,853:865]=c(2,4); x[,866:867]=c(2,5); x[,868:870]=c(2,6);
x[,871:915]=c(3,1); x[,916:1006]=c(3,2); x[,1007:1190]=c(3,3);
x[,1191:1215]=c(3,4); x[,1216:1219]=c(3,5); x[,1220:1224]=c(3,6);
x[,1225:1239]=c(4,1); x[,1240:1256]=c(4,2); x[,1257:1291]=c(4,3);
x[,1292:1308]=c(4,4); x[,1309:1312]=c(4,5); x[,1313:1314]=c(4,6);
x[,1315:1324]=c(5,1); x[,1325:1328]=c(5,2); x[,1329:1337]=c(5,3);
x[,1338:1342]=c(5,4); x[,1343:1344]=c(5,5); x[,1345:1355]=c(6,1);
x[,1356:1364]=c(6,2); x[,1365:1368]=c(6,3); x[,1369:1371]=c(6,4);
x[,1372:1372]=c(6,5); x[,1373:1377]=c(6,6);
x=t(x)

xx=(x[,1]-mean(x[,1]))/sd(x[,1])
yy=(x[,2]-mean(x[,2]))/sd(x[,2])

lnpost=function(r)
 {-690*log(1-r^2)-.5*(sum(xx^2)-2*r*sum(xx*yy)+sum(yy^2))/(1-r^2)}

corr=matrix(0,10000); acctot=0
for(i in 2:10000)
 {
  corr[i]=corr[i-1]+runif(1,min=-.07,max=.07)
  acc=1
  if(abs(corr[i])>1){acc=0; corr[i]=corr[i-1]}
  if((lnpost(corr[i])-lnpost(corr[i-1]))<log(runif(1,min=0,max=1)))
   {corr[i]=corr[i-1]; acc=0}
  acctot=acctot+acc
  if(i%%100==0){print(c(i,corr[i],acctot/i))}
 }
